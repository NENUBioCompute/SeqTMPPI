Index: _8humanPredict.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># Title     : _8humanPredict.py\r\n# Created by: julse@qq.com\r\n# Created on: 2021/3/3 10:00\r\n# des : TODO\r\nimport os\r\nimport time\r\nimport pandas as pd\r\nfrom FastaDealear import FastaDealer\r\nfrom FeatureDealer import BaseFeature, Feature_type\r\n# from common import check_path, concatFile\r\n# from dao import generateHumanLists, composeTMP_nonTMP, fullyComposeTMP_nonTMP, getPairInfo, getSingleInfo\r\n# from dataset import saveQualified, extractPairAndFasta, simplifyTable, saveFasta\r\n# from mySupport import savepredict\r\n# from negativeData import dropPositiveAndRepeate\r\nfrom PairDealer import PairDealer\r\nfrom common import check_path\r\nfrom mySupport import savepredict\r\n\r\nif __name__ == '__main__':\r\n    print('start', time.strftime('%Y-%m-%d %H:%M:%S', time.localtime()))\r\n    start = time.time()\r\n\r\n    fpositive = 'file/1positive/2pair.tsv'\r\n    dir_feature_db = '/home/19jjhnenu/Data/SeqTMPPI2W/featuredb/human/'\r\n    dirout_feature = '/home/19jjhnenu/Data/SeqTMPPI2W/feature/human1/'\r\n    fin_model = '/home/19jjhnenu/Data/SeqTMPPI2W/result/129878/_my_model.h5'\r\n    dirout_result = '/home/19jjhnenu/Data/SeqTMPPI2W/result/129878/testHuman'\r\n\r\n    fin_model_group0 = '/home/19jjhnenu/Data/SeqTMPPI2W/result/group/0/_my_model.h5'\r\n    dirout_result_group0 = '/home/19jjhnenu/Data/SeqTMPPI2W/result/group/0/testHuman'\r\n\r\n    dirout = 'file/8humanPredict'\r\n    f1tmp = os.path.join(dirout,'1tmp.list')\r\n    f1nontmp = os.path.join(dirout,'1nontmp.list')\r\n\r\n    f2tmpInfo = os.path.join(dirout,'2tmpInfo.tsv')\r\n    f2nontmpInfo = os.path.join(dirout,'2nontmpInfo.tsv')\r\n\r\n    f2tmp = os.path.join(dirout, '2tmp.list')\r\n    f2nontmp = os.path.join(dirout, '2nontmp.list')\r\n\r\n    f3pair = os.path.join(dirout,'3pair.tsv')\r\n\r\n    f3pair_norepeat = os.path.join(dirout,'3pair_norepeat.tsv')\r\n\r\n    f3pairInfo = os.path.join(dirout,'2pairInfo.tsv')\r\n    f3tmp_fasta = os.path.join(dirout,'3tmp.fasta')\r\n    f3nontmp_fasta = os.path.join(dirout,'3nontmp.fasta')\r\n    f3all_fasta = os.path.join(dirout,'3all.fasta')\r\n\r\n    dir3bathData = os.path.join(dirout,'3batchData')\r\n    check_path(dir3bathData)\r\n    f4sample1k = os.path.join(dir3bathData,'3batchData')\r\n\r\n\r\n    '''\r\n    get TMP, nonTMP list\r\n    query 5208 tmp and 15186 nontmp\r\n    '''\r\n    # generateHumanLists(f1tmp, f1nontmp)\r\n    '''\r\n    get single info\r\n    '''\r\n    # getSingleInfo(f1tmp,f1tmpInfo,fin_type='single')\r\n    # getSingleInfo(f1nontmp,f1nontmpInfo,fin_type='single')\r\n    '''\r\n    get qualified protein\r\n    '''\r\n    # df = pd.read_table(f2tmpInfo, header=None)\r\n    # df[0].to_csv(f2tmp,header=None,index=None,sep='\\t')\r\n\r\n    # df = pd.read_table(f2nontmpInfo, header=None)\r\n    # df[0].to_csv(f2nontmp,header=None,index=None,sep='\\t')\r\n    '''\r\n    get TMP_nonTMP pair\r\n    time 367.5028109550476\r\n    '''\r\n    # fullyComposeTMP_nonTMP(f2tmp, f2nontmp, f3pair)\r\n    '''\r\n    drop repeat and positive\r\n    '''\r\n    # dropPositiveAndRepeate(f3pair, fpositive, f3pair_norepeat)\r\n\r\n    '''\r\n    get fasta and qualifeid pair\r\n    '''\r\n    # saveFasta(f2tmpInfo, f3tmp_fasta, AC=0, Seq=6)\r\n    # saveFasta(f2nontmpInfo, f3nontmp_fasta, AC=0, Seq=6)\r\n    # concatFile([f3tmp_fasta,f3nontmp_fasta],f3all_fasta)\r\n\r\n    '''\r\n    generate feature db\r\n    '''\r\n    print('generate feature db')\r\n    # fd = FastaDealer()\r\n    # fd.getNpy(f3all_fasta, dir_feature_db)\r\n    '''\r\n    generate feature\r\n    '''\r\n    print('generate feature')\r\n    # pdealer = PairDealer()\r\n    # pdealer.sample(f3pair_norepeat,10000,f4sample1k)\r\n    # if os.path.exists(dirout_feature):os.removedirs(dirout_feature)\r\n    # check_path(dirout_feature)\r\n    # BaseFeature().base_compose(dirout_feature, f4sample1k, dir_feature_db, feature_type=Feature_type.SEQ_1D)\r\n    print('end of delete feature')\r\n    '''\r\n    testing on the model\r\n    '''\r\n    import os\r\n    import tensorflow as tf\r\n\r\n    gpu_id = '0,1,2,3'\r\n    gpu_id = '6,7'\r\n    os.environ['CUDA_VISIBLE_DEVICES'] = str(gpu_id)\r\n    os.system('echo $CUDA_VISIBLE_DEVICES')\r\n\r\n    tf_config = tf.compat.v1.ConfigProto()\r\n    tf_config.gpu_options.allow_growth = True\r\n    tf.compat.v1.Session(config=tf_config)\r\n\r\n    print('testing the model')\r\n    # savepredict(f4sample1k, dirout_feature, fin_model, dirout_result,batch_size=500)\r\n    savepredict(f4sample1k, dirout_feature, fin_model_group0, dirout_result_group0,batch_size=500)\r\n\r\n\r\n    # df = pd.read_table(f15Tmp_nonTMP_hasPDB, header=None)\r\n    # df1.to_csv(fout,header=None,index=None,sep='\\t')\r\n    print('stop', time.strftime('%Y-%m-%d %H:%M:%S', time.localtime()))\r\n    print('time', time.time() - start)\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/_8humanPredict.py b/_8humanPredict.py
--- a/_8humanPredict.py	(revision 4b2c6d723062f080f932c84d3b51d3e52a3b8922)
+++ b/_8humanPredict.py	(date 1615362032740)
@@ -129,3 +129,4 @@
     print('stop', time.strftime('%Y-%m-%d %H:%M:%S', time.localtime()))
     print('time', time.time() - start)
 
+
